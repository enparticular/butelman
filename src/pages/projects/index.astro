---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import ProjectCard from '../../components/ProjectCard.astro';

// Get all projects and separate by category
const projects: CollectionEntry<'projects'>[] = await getCollection('projects');

// Filter and sort music projects
const musicProjects = projects
  .filter(p => p.data.category === 'music')
  .sort((a, b) => {
    if (a.data.order !== undefined && b.data.order !== undefined) {
      return a.data.order - b.data.order;
    } else if (a.data.order !== undefined) {
      return -1;
    } else if (b.data.order !== undefined) {
      return 1;
    }
    return 0;
  });

// Filter and sort cinema/theater projects
const cinemaTheaterProjects = projects
  .filter(p => p.data.category === 'cinema/theater')
  .sort((a, b) => {
    if (a.data.order !== undefined && b.data.order !== undefined) {
      return a.data.order - b.data.order;
    } else if (a.data.order !== undefined) {
      return -1;
    } else if (b.data.order !== undefined) {
      return 1;
    }
    return 0;
  });
---

<Layout title="Projects">
  <main class="min-h-screen py-16">
    <div class="container">
      <h1 class="text-4xl font-bold text-gray-800 mb-12">All Projects</h1>
      
      <section class="mb-16">
        <h2 class="text-3xl font-bold text-gray-800 mb-6">Music</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {musicProjects.map(project => (
            <ProjectCard project={project} />
          ))}
        </div>
      </section>
      
      <section>
        <h2 class="text-3xl font-bold text-gray-800 mb-6">Cinema / Theater</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {cinemaTheaterProjects.map(project => (
            <ProjectCard project={project} />
          ))}
        </div>
      </section>
    </div>
  </main>
</Layout>